<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BookBuddy — Demo</title>

  <!-- fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700;800&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="style.css" />
</head>
<body data-page="home">
  <div class="page-wrap">
    <div class="site">

      <header>
        <div style="display:flex;align-items:center;gap:12px">
          <div class="logo" aria-hidden="true">
            <svg viewBox="0 0 100 80" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <rect x="6" y="8" width="22" height="62" rx="3" fill="#d9443f"/>
              <rect x="36" y="8" width="22" height="62" rx="3" fill="#d9443f" opacity="0.95"/>
            </svg>
            <h1>BookBuddy</h1>
          </div>
        </div>

        <nav class="top-nav" aria-label="Main navigation">
          <a href="#" data-route="home" class="nav-link">Home</a>
          <a href="#" data-route="buy" class="nav-link">Buy</a>
          <a href="#" data-route="sell" class="nav-link">Sell</a>
          <a href="#" data-route="donate" class="nav-link">Donate</a>
          <!-- LOGIN / SIGNUP moved into nav -->
          <a href="#" id="loginNavBtn">Login / Sign up</a>
        </nav>
      </header>

      <!-- HERO -->
      <section class="hero page active" id="homePage">
        <h2 id="hero-heading">Every Book Deserves<br>a Second Reader.</h2>

        <!-- Search bar moved under tagline -->
        <div class="search-wrap" style="max-width:900px;margin:0 auto 8px;">
          <input id="globalSearch" class="search-input" placeholder="Search books, authors, publishers or users..." />
          <button class="search-btn" id="searchBtn">Search</button>
        </div>

        <div class="cta-row" role="group" aria-label="Calls to action">
          <button class="primary-btn" data-route="buy">Buy Books</button>
          <button class="primary-btn" data-route="sell">Sell Your Book</button>
          <button class="primary-btn" data-route="donate">Donate</button>
        </div>

        <div style="max-width:900px;margin:0 auto;text-align:center">
          <p style="color:var(--muted);margin:0 0 12px">Search or browse books below. Click a book to chat with the seller.</p>
        </div>

        <h3 class="section-title">Explore Books</h3>

        <div id="homeGrid" class="grid" aria-live="polite">
          <!-- books inserted by JS -->
        </div>
      </section>

      <!-- BUY PAGE -->
      <section class="page" id="buyPage" aria-hidden="true">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <h3 class="section-title">Buy Books</h3>
          <div style="color:var(--muted);font-size:14px">Showing available books</div>
        </div>

        <div id="buyGrid" class="grid"></div>
      </section>

      <!-- SELL PAGE -->
      <section class="page" id="sellPage" aria-hidden="true">
        <h3 class="section-title">Sell a Book</h3>
        <div class="form" style="max-width:760px">
          <div class="field">
            <label>Book Title</label>
            <input id="sellTitle" placeholder="E.g., The Alchemist" />
          </div>
          <div class="two-col">
            <div class="field">
              <label>Author</label>
              <input id="sellAuthor" placeholder="Author name" />
            </div>
            <div class="field">
              <label>Publisher</label>
              <input id="sellPublisher" placeholder="Publisher" />
            </div>
          </div>
          <div class="two-col">
            <div class="field">
              <label>Price (₹)</label>
              <input id="sellPrice" type="number" placeholder="e.g., 350" />
            </div>
            <div class="field">
              <label>Condition</label>
              <select id="sellCondition">
                <option>New</option>
                <option>Used - Like New</option>
                <option>Used - Good</option>
                <option>Used - Acceptable</option>
              </select>
            </div>
          </div>

          <div class="field">
            <label>Cover Image URL (optional)</label>
            <input id="sellImage" placeholder="Paste an image URL or leave blank for template image" />
          </div>

          <div style="display:flex;gap:10px;margin-top:8px">
            <button class="primary-btn" id="postListingBtn">Post Listing</button>
            <button class="secondary-btn" id="clearSell">Clear</button>
          </div>

          <p style="color:var(--muted);font-size:13px;margin-top:10px">You must be logged in to post. If not logged in you will be prompted to login/signup.</p>
        </div>
      </section>

      <!-- DONATE PAGE -->
      <section class="page" id="donatePage" aria-hidden="true">
        <h3 class="section-title">Donate Books</h3>
        <div class="form" style="max-width:760px">
          <div class="field">
            <label>Book Title</label>
            <input id="donateTitle" placeholder="E.g., The Little Prince" />
          </div>
          <div class="field">
            <label>Author / Publisher</label>
            <input id="donateMeta" placeholder="Author or Publisher name" />
          </div>
          <div class="field">
            <label>Pickup Location (optional)</label>
            <input id="donateLocation" placeholder="City, area" />
          </div>
          <div style="display:flex;gap:10px;margin-top:8px">
            <button class="primary-btn" id="postDonateBtn">Post Donation</button>
          </div>
          <p style="color:var(--muted);font-size:13px;margin-top:10px">Donations are posted as free listings for others to claim.</p>
        </div>
      </section>

      <!-- LOGIN / SIGNUP MODAL -->
      <div id="authModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true" style="max-width:480px;height:auto;">
        <div class="modal-header">
          <div style="font-weight:700">Login / Sign up</div>
          <div><button class="secondary-btn" id="closeAuth">Close</button></div>
        </div>

        <div style="padding:12px; display:grid; gap:10px">
          <div id="authForm">
            <div class="field"><label>Email</label><input id="authEmail" placeholder="you@example.com" /></div>
            <div class="field"><label>Username</label><input id="authUser" placeholder="choose a username" /></div>
            <div class="field"><label>Password</label><input id="authPass" type="password" placeholder="password" /></div>

            <div style="display:flex;gap:8px">
              <button class="primary-btn" id="signupBtn">Create account</button>
              <button class="secondary-btn" id="loginExistingBtn">Login</button>
            </div>

          </div>
        </div>
      </div>

      <!-- CHAT MODAL (shared for listing chat & global chats) -->
      <div id="chatModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
        <div class="modal-header">
          <div id="chatTitle">Chat</div>
          <div><button class="secondary-btn" id="closeChat">Close</button></div>
        </div>

        <div class="messages" id="messagesArea" aria-live="polite"></div>

        <div class="chat-input">
          <input id="chatInput" placeholder="Write your message..." />
          <button id="sendChatBtn">Send</button>
        </div>
      </div>

      <!-- global chat floating button -->
      <div class="floating-chat">
        <button id="openChats">Chats</button>
      </div>

      <footer>
        <a href="#" id="privacyLink">Privacy Policy</a> • ©2025 BookBuddy
      </footer>
    </div>
  </div>


  <script>
document.addEventListener("DOMContentLoaded", async () => {
  try {
    const res = await fetch("/api/books");
    const books = await res.json();

    const container = document.getElementById("homeGrid");
    if (!container) return;

    if (books.length === 0) {
      container.innerHTML = "<p>No books listed yet.</p>";
      return;
    }

    container.innerHTML = books.map(book => `
      <div class="book-card">
        <img src="${book.image || '/default.jpg'}" alt="${book.title}">
        <h3>${book.title}</h3>
        <p>Author: ${book.author}</p>
        <p>Publisher: ${book.publisher}</p>
        <p>Seller: ${book.seller}</p>
      </div>
    `).join("");
  } catch (err) {
    console.error("Error loading books:", err);
  }
});
</script>


<script>
async function loadBooks() {
  try {
    const res = await fetch("/api/books");
    const books = await res.json();

    // Home page container
    const homeGrid = document.getElementById("homeGrid");
    if (homeGrid) {
      homeGrid.innerHTML = books.length
        ? books.map(book => `
            <div class="book-card">
              <img src="${book.image || '/default.jpg'}" alt="${book.title}">
              <h3>${book.title}</h3>
              <p>Author: ${book.author}</p>
              <p>Publisher: ${book.publisher}</p>
              <p>Seller: ${book.seller}</p>
            </div>
          `).join("")
        : "<p>No books listed yet.</p>";
    }

    // Buy page container
    const buyGrid = document.getElementById("buyGrid");
    if (buyGrid) {
      buyGrid.innerHTML = books.length
        ? books.map(book => `
            <div class="book-card">
              <img src="${book.image || '/default.jpg'}" alt="${book.title}">
              <h3>${book.title}</h3>
              <p>Author: ${book.author}</p>
              <p>Publisher: ${book.publisher}</p>
              <p>Price: ₹${book.price || 0}</p>
              <p>Condition: ${book.condition || 'Used - Good'}</p>
              <p>Seller: ${book.seller}</p>
            </div>
          `).join("")
        : "<p>No books available for sale.</p>";
    }

  } catch (err) {
    console.error("Error loading books:", err);
  }
}

// Load books once the DOM is ready
document.addEventListener("DOMContentLoaded", loadBooks);
</script>



  <script src="script.js" defer></script>
</body>
</html>
